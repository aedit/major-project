<script>
  const { PythonShell } = require('python-shell')
  const { ipcRenderer } = require('electron')
  const path = require('path')

  ipcRenderer.on('START_PROCESSING', (event, args) => {
    let options = {
      pythonPath: '/home/vaibhav/.anaconda/bin/python',
      pythonOptions: ['-u'], // get print results in real-time
      scriptPath: `${__dirname}/../scripts/`
    }

    let pyshell = new PythonShell('detect_blink.py', options)

    //ipcRenderer.send('MESSAGE_FROM_BACKGROUND', { message: pyshell })

    pyshell.on('message', function(results) {
      ipcRenderer.send('MESSAGE_FROM_BACKGROUND', { message: results })
    })

    pyshell.on('stderr', function(stderr) {
      // handle stderr (a line of text from stderr)
      ipcRenderer.send('MESSAGE_FROM_BACKGROUND', { message: stderr })
    })
    pyshell.on('close', () => {
      ipcRenderer.send('STOP_HIDDEN')
    })
  })

  ipcRenderer.send('BACKGROUND_READY')
</script>
